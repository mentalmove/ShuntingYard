(function(s,b){function e(t,i,f){switch(f){case"+":return(t+i);break;case"-":return(t-i);break;case"*":return(t*i);break;case"/":if(!i){if(!t){return 0}if(t>0){return Number.MAX_VALUE}return(-1*Number.MAX_VALUE)}return(t/i)}}function o(f){var i=0;while(f.length>1){while(!isNaN(f[i])){i++}f[i]=e(f[i-2],f[i-1],f[i]);f.splice(i-2,2);i-=2}return f[0]}function j(v){var t={"+":2,"-":2,"*":3,"/":3};var i=[];var f=[];var u;while(v.length){u=v.shift();if(!isNaN(u)){i.push(u);continue}if(t[u]){while(f.length&&t[f[f.length-1]]>=t[u]){i.push(f.pop())}f.push(u);continue}if(u=="("){f.push(u);continue}if(u==")"){while(f[f.length-1]!="("){i.push(f.pop())}f.pop()}}while(f.length){i.push(f.pop())}return i}var a=[];function h(f){return s.getElementById(f)}function p(y,t){if(y.length<3){return 0}var w;var v=[];var z=0;var u=0;var x=0;for(w=0;w<y.length;w++){if(y[w]=="("){z++}if(y[w]==")"){z--}if(!isNaN(y[w])){x++}else{if(y[w].match(/[+\-\*\/]/)){u++}}if(z<0){return 0}if((x-u)&&(x-u)!=1){return 0}v.push(y[w])}if((x-u)!=1){if(t){for(w=v.length-1;w>1;w--){if(isNaN(v[w])&&v[w].match(/[+\-\*\/]/)){var f=(v[w].match(/[+\-]/))?0:1;v.splice((w+1),0,f);break}}}else{return 0}}if(z){if(t){for(w=v.length-1;w>=0;w--){if(v[w]=="("){v.splice(w,1);z--;if(!z){break}}}}else{return 0}}for(w=0;w<v.length;w++){if(!isNaN(v[w])){v[w]=parseFloat(v[w])}}return v}var d={"รท":"/",c:"C",AC:"C",Backspace:"C",",":".",x:"*"};var q="operator";function m(v,y){if(!y){n[v].style.backgroundColor="silver";return}n[v].style.backgroundColor="gray";var u=d[v]||v;if(q=="finished"){if(u!="C"){return}h("calc_result").innerHTML=".&nbsp;";h("infix").innerHTML="";h("postfix").innerHTML="";a=[];q="operator";h("clear_it").innerHTML="C"}var t;if(u=="="&&a.length>2){for(t=0;t<a.length;t++){if(!isNaN(a[t])){a[t]=parseFloat(a[t])}}if(!p(a,0)){return}var f=j(a);h("postfix").innerHTML=f.join(" ");h("calc_result").innerHTML=o(f)+"&nbsp;";q="finished";h("clear_it").innerHTML="AC";return}if(u=="C"&&a.length){a.pop();if(!a.length){q="operator";h("calc_result").innerHTML=".&nbsp;"}}else{if(u=="-"){a.push("-");if(q=="operator"||q=="("){q="number"}else{q="operator"}}else{if(u=="("||u==")"){q=u;a.push(u)}else{if(u.match(/[+\*\/]/)){q="operator";a.push(u)}else{if(u.match(/[\d\.]/)){if(u=="."){if(q!="number"){u="0."}else{if(a[a.length-1].toString().match(/\./)){return}}}if(q!="number"){a.push(u)}else{a[a.length-1]+=u}q="number"}}}}}if(a.length){h("calc_result").innerHTML=a[a.length-1]+"&nbsp;"}h("infix").innerHTML=a.join(" ").replace(/\(\s?/g,"(").replace(/\s?\)/g,")");var x=p(a,1);if(!x){return}var w=j(x);h("postfix").innerHTML=w.join(" ");if(q!="("&&q!="number"){for(t=0;t<a.length;t++){if(a[t]=="("){h("calc_result").innerHTML=r(a)+"&nbsp;";return}}h("calc_result").innerHTML=o(w)+"&nbsp;"}}function r(w){var t=[];var y=0;var x;for(var f=w.length-1;f>=0;f--){x=(!isNaN(w[f]))?parseFloat(w[f]):w[f];if(x==")"){y++}if(x=="("){y--;if(!y){t.unshift(x);break}if(y<0){return w[w.length-1]}}t.unshift(x)}if(t.length==1){return t[0]}var v=p(t,1);if(!v){return w[w.length-1]}var u=j(v);return o(u)}var g;var c=s.getElementsByClassName("char");var n={};var l,k;for(g=0;g<c.length;g++){l=c[g].innerHTML;n[l]=c[g];c[g].onmousedown=function(){m(this.innerHTML,1)};c[g].onmouseup=function(){m(this.innerHTML,0)}}n["/"]=n["รท"];n["*"]=n.x;n.c=n.C;n.AC=n.C;n[","]=n["."];n.Backspace=n.C;s[b].onkeydown=function(f){if(!n[f.key]){return}f.preventDefault();m(f.key,1)};s[b].onkeyup=function(f){if(!n[f.key]){return}m(f.key,0)}})(document,"body");